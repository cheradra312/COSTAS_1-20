<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor de Mapas Conceptuales</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome para los iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .topic-button {
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            color: #374151;
            padding: 1rem;
            border-radius: 0.75rem;
            text-align: left;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .topic-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        }
        
        .topic-number {
            border-radius: 9999px;
            font-weight: 700;
            font-size: 1.125rem;
            width: 2.75rem;
            height: 2.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s ease-in-out;
        }
        
        .topic-title {
            font-weight: 600;
            flex-grow: 1;
        }

        .topic-icon {
            font-size: 1.25rem;
            width: 2rem;
            text-align: center;
            transition: color 0.2s ease-in-out;
        }

        .control-button {
             transition: background-color 0.2s;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- VISTA DEL MENÚ PRINCIPAL -->
        <div id="main-menu-view">
            <header class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800">Visor de Mapas Conceptuales</h1>
                <p class="text-lg text-gray-500 mt-2">Selecciona un tema para comenzar</p>
            </header>
            <div id="topics-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <!-- Los botones se generarán aquí con JavaScript -->
            </div>
        </div>

        <!-- VISTA DEL VISOR DE MAPAS (inicialmente oculta) -->
        <div id="map-viewer-view" class="hidden">
            <div class="flex items-center gap-4 mb-4">
                 <button id="back-button" class="control-button bg-white text-gray-700 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-100 flex items-center gap-2">
                    <i class="fas fa-arrow-left"></i>
                    Volver al Menú
                </button>
                <button id="play-audio-button" class="control-button bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-600 flex items-center gap-2">
                    <i id="play-icon" class="fas fa-play"></i>
                    <span id="play-text">Reproducir Audio</span>
                </button>
            </div>
            <div class="bg-white p-2 rounded-xl shadow-lg border border-gray-200">
                <iframe id="content-frame" 
                        class="w-full border-0 rounded-lg" 
                        style="min-height: 85vh;" 
                        src="">
                    Tu navegador no soporta iframes.
                </iframe>
            </div>
        </div>
        <!-- Elemento de audio, oculto pero funcional -->
        <audio id="topic-audio" src=""></audio>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Lista de todos los temas con sus títulos, colores e iconos
            const topics = [
                { file: 'MEA2T1_Desplegable.html', title: 'La Legislación de Costas', color: 'blue', icon: 'fa-gavel' },
                { file: 'MEA2T2_DESPLEGABLE.html', title: 'Bienes de Dominio Público', color: 'cyan', icon: 'fa-landmark' },
                { file: 'MEA2T3_DESPLEGABLE.html', title: 'Limitaciones a la Propiedad', color: 'sky', icon: 'fa-ban' },
                { file: 'MEA2T4_DESPLEGABLE.html', title: 'Utilización del DPM-T', color: 'indigo', icon: 'fa-swimmer' },
                { file: 'MEA2T5_DESPLEGABLE.html', title: 'Régimen Económico-Financiero', color: 'green', icon: 'fa-coins' },
                { file: 'MEA2T6_DESPLEGABLE.html', title: 'Competencias de la AGE', color: 'emerald', icon: 'fa-building-columns' },
                { file: 'MEA2T7_DESPLEGABLE.html', title: 'Régimen Transitorio', color: 'teal', icon: 'fa-history' },
                { file: 'MEA2T8_DESPLEGABLE.html', title: 'Autorizaciones en Servidumbre', color: 'lime', icon: 'fa-file-signature' },
                { file: 'MEA2T9_DESPLEGABLE.html', title: 'Biodiversidad y conservación', color: 'yellow', icon: 'fa-seedling' },
                { file: 'MEA2T10_DESPLEGABLE.html', title: 'La gestión integral del litoral', color: 'amber', icon: 'fa-tasks' },
                { file: 'MEA2T11_DESPLEGABLE.html', title: 'Las distintas teorías de ondas', color: 'orange', icon: 'fa-wave-square' },
                { file: 'MEA2T12_DESPLEGABLE.html', title: 'El transporte sólido litoral', color: 'red', icon: 'fa-arrows-left-right' },
                { file: 'MEA2T13_DESPLEGABLE.html', title: 'Efectos del cambio climático', color: 'rose', icon: 'fa-temperature-high' },
                { file: 'MEA2T14_DESPLEGABLE.html', title: 'Las estrategias marinas en España', color: 'pink', icon: 'fa-map' },
                { file: 'MEA2T15_DESPLEGABLE.html', title: 'La erosión en playas', color: 'fuchsia', icon: 'fa-mountain-sun' },
                { file: 'MEA2T16_DESPLEGABLE.html', title: 'Proyectos de Playas Artificiales', color: 'purple', icon: 'fa-umbrella-beach' },
                { file: 'MEA2T17_DESPLEGABLE.html', title: 'Fuentes Naturales de Sedimentos', color: 'violet', icon: 'fa-stream' },
                { file: 'MEA2T18_DESPLEGABLE.html', title: 'El Puerto', color: 'gray', icon: 'fa-anchor' },
                { file: 'MEA2T19_DESPLEGABLE.html', title: 'Obras Portuarias (I)', color: 'slate', icon: 'fa-hard-hat' },
                { file: 'MEA2T20_DESPLEGABLE.html', title: 'Obras Portuarias (II)', color: 'zinc', icon: 'fa-ship' }
            ];

            const colorPalette = {
                blue:   { normal: 'bg-blue-100 text-blue-800',   icon: 'text-blue-500'   },
                cyan:   { normal: 'bg-cyan-100 text-cyan-800',   icon: 'text-cyan-500'   },
                sky:    { normal: 'bg-sky-100 text-sky-800',     icon: 'text-sky-500'    },
                indigo: { normal: 'bg-indigo-100 text-indigo-800', icon: 'text-indigo-500' },
                green:  { normal: 'bg-green-100 text-green-800',   icon: 'text-green-500'  },
                emerald:{ normal: 'bg-emerald-100 text-emerald-800',icon: 'text-emerald-500'},
                teal:   { normal: 'bg-teal-100 text-teal-800',     icon: 'text-teal-500'   },
                lime:   { normal: 'bg-lime-100 text-lime-800',     icon: 'text-lime-500'   },
                yellow: { normal: 'bg-yellow-100 text-yellow-800', icon: 'text-yellow-500' },
                amber:  { normal: 'bg-amber-100 text-amber-800',   icon: 'text-amber-500'  },
                orange: { normal: 'bg-orange-100 text-orange-800', icon: 'text-orange-500' },
                red:    { normal: 'bg-red-100 text-red-800',       icon: 'text-red-500'    },
                rose:   { normal: 'bg-rose-100 text-rose-800',     icon: 'text-rose-500'   },
                pink:   { normal: 'bg-pink-100 text-pink-800',     icon: 'text-pink-500'   },
                fuchsia:{ normal: 'bg-fuchsia-100 text-fuchsia-800',icon: 'text-fuchsia-500'},
                purple: { normal: 'bg-purple-100 text-purple-800', icon: 'text-purple-500' },
                violet: { normal: 'bg-violet-100 text-violet-800', icon: 'text-violet-500' },
                gray:   { normal: 'bg-gray-100 text-gray-800',     icon: 'text-gray-500'   },
                slate:  { normal: 'bg-slate-100 text-slate-800',   icon: 'text-slate-500'  },
                zinc:   { normal: 'bg-zinc-100 text-zinc-800',     icon: 'text-zinc-500'   },
            };

            const gridContainer = document.getElementById('topics-grid');
            const iframe = document.getElementById('content-frame');
            const mainMenuView = document.getElementById('main-menu-view');
            const mapViewerVIew = document.getElementById('map-viewer-view');
            const backButton = document.getElementById('back-button');
            const playAudioButton = document.getElementById('play-audio-button');
            const topicAudio = document.getElementById('topic-audio');
            const playIcon = document.getElementById('play-icon');
            const playText = document.getElementById('play-text');

            // Generar los botones dinámicamente
            topics.forEach((topic, index) => {
                const button = document.createElement('button');
                const colors = colorPalette[topic.color];
                button.className = 'topic-button';
                button.dataset.src = topic.file;
                button.dataset.audioSrc = `audios/${topic.file.replace('.html', '.mp3')}`;
                button.innerHTML = `
                    <span class="topic-number ${colors.normal}">${index + 1}</span>
                    <i class="fas ${topic.icon} topic-icon ${colors.icon}"></i>
                    <span class="topic-title">${topic.title}</span>
                `;
                gridContainer.appendChild(button);
            });

            // Función para mostrar la vista del mapa
            function showMapView(button) {
                mainMenuView.classList.add('hidden');
                mapViewerVIew.classList.remove('hidden');
                iframe.src = button.dataset.src;
                topicAudio.src = button.dataset.audioSrc;
                resetAudioPlayer();
            }

            // Función para mostrar el menú principal
            function showMainMenu() {
                mapViewerVIew.classList.add('hidden');
                mainMenuView.classList.remove('hidden');
                topicAudio.pause(); // Detener el audio si se está reproduciendo
                iframe.src = ''; 
            }

            // Función para resetear el estado del botón de audio
            function resetAudioPlayer() {
                playIcon.classList.remove('fa-pause');
                playIcon.classList.add('fa-play');
                playText.textContent = 'Reproducir Audio';
            }

            // Control del reproductor de audio
            playAudioButton.addEventListener('click', function() {
                if (topicAudio.paused) {
                    topicAudio.play();
                    playIcon.classList.remove('fa-play');
                    playIcon.classList.add('fa-pause');
                    playText.textContent = 'Pausar Audio';
                } else {
                    topicAudio.pause();
                    resetAudioPlayer();
                }
            });

            // Cuando el audio termina, resetea el botón
            topicAudio.addEventListener('ended', resetAudioPlayer);

            // Añadir event listener a la cuadrícula
            gridContainer.addEventListener('click', function(event) {
                const button = event.target.closest('.topic-button');
                if (button) {
                    showMapView(button);
                }
            });
            
            // Añadir event listener al botón de "Volver"
            backButton.addEventListener('click', showMainMenu);
        });
    </script>
</body>
</html>

